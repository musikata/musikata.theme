@import "../utils";
@import "../settings";
@import "../foundation-icons";

.feel-the-beat-exercise{

  > .body-region{
    height: 100%;
    width: 100%;
  }

  .tap-view, .results-view {
    height: 100%;
    width: 100%;
    display: flex;

  }

  .tap-view{
    $padding: 4%;

    @media #{$landscape} {
      flex-direction: row;
    }

    @media #{$portrait} {
      flex-direction: column;
    }

    > div {
      flex: 1 1 50%;
      align-self: center;
    }

    .text-region {
      order: 0;
    }

    .drum-region {
      order: 1;
    }

    .instructions {
      margin: $padding;
      font-style: italic;
      list-style: none;
      text-align: center;

      li {
        display: none;

        &.active {
          display: block;
        }

        button {
          @include round-corners(.5em);
          margin: inherit;
          padding: .5em;
        }
      }

    }

    .drum-region{
      height: 100%;
      position: relative;
      .drum {
        $drum_relative_size: .92;
        $radius: ($min_slide_size * $drum_relative_size)/2.0;
        $overlayRadius: $radius * .8;
        width: $radius*2;
        height: $radius*2;
        margin: auto;
        margin-top: $padding * .62 ;
        @include round-corners($radius);
        background-image: url('../img/feelTheBeat/drum.jpg');
        background-size: 100% 100%;
        background-repeat: no-repeat;
        position: relative;

        .overlay {
          $padding: ($radius - $overlayRadius);
          position: absolute;
          top: $padding;
          left: $padding;
          opacity: 0;
          width: $overlayRadius*2;
          height: $overlayRadius*2;
          @include round-corners($overlayRadius);
          background: $primary-color;
        }

        &.disabled {
          .overlay {
            opacity: .75;
            background: gray;
          }
        }

        &:hover {
          cursor: pointer;
          .overlay {
            opacity: .2;
          }
        }

        &.tapping{
          .overlay {
            opacity: .5;
          }
        }
      }
    }
  }

  .results-view {
    flex-direction: column;

    .text {
      flex: 0 0 auto;
      text-align: center;
      @include round-corners(rem-calc(8));
      &.pass {
        background-color: $pass_color;
      }

      &.fail {
        background-color: $fail_color;
        color: white;
      }
    }

    .figure {
      $icon_size: 1em;
      $threshold_padding: 5%;
      $threshold_height: 100% - 2*$threshold_padding;
      $mark_width: 1%;
      $mark_length: 42%;
      $mark_padding: 2%;
      $link_top: $threshold_padding + $mark_padding + $mark_length;
      $link_height: $threshold_height - 2*$mark_length - 2*$mark_padding;
      flex: 1 1 auto;
      align-self: stretch;
      width: 100%;
      height: 100%;
      position: relative;

      display: flex;
      @media #{$landscape} {
        flex-direction: column;
      }
      @media #{$portrait} {
        flex-direction: row;
      }

      .result-indicators {
        flex: 0 0 2*$icon_size;
        align-self: center;
        width: 100%;
        position: relative;

        .result {
          $radius: $icon_size;
          position: absolute;
          font-size: $icon_size;
          width: $radius*2;
          height: $radius*2;
          @include round-corners($radius);
          text-align: center;

          @media #{$landscape} {
            top: inherit !important;
            margin-left: -$radius;
          }
          @media #{$portrait} {
            left: inherit !important;
            margin-top: -$radius;
          }

          i {
            display: inline-block;
            vertical-align: middle;
            line-height: 2em;

            &.pass {
              @include fi-check;
              color: $pass_color;
            }
            &.fail {
              @include fi-x;
              color: $fail_color;
            }
          }
        }
      }

      .timeline {
        flex: 1 1 auto;
        align-self: stretch;
        width: 100%;
        height: 100%;
        position: relative;

        > div, svg{
          position: absolute;
        }

        // Colors, borders.
        .threshold {
          border: thin dashed #666;
        }

        .beat {
          background: #3d1c1c;
        }

        .tap {
          &.pass {
            background: $pass_color;
          }
          &.fail {
            background: $fail_color;
          }
        }

        .link {
          line {
            stroke-width: 1;
            stroke: black;
            stroke-dasharray: 2,2; 
          }
        }

        // Positioning, per orientation.
        @media #{$landscape} {
          .threshold {
            top: $threshold_padding !important;
            height: $threshold_height !important;
            left: inherit !important;
            width: inherit !important;
          }

          .tap, .beat {
            width: $mark_width !important;
            height: $mark_length !important;
            margin-left: -$mark_width/2;
          }

          .beat {
            top: $threshold_padding + $mark_padding !important;
            bottom: inherit !important;
          }

          .tap {
            top: inherit !important;
            bottom: $mark_padding + $threshold_padding !important;
          }

          .link {
            top: $link_top !important;
            height: $link_height !important;
          }
        }

        @media #{$portrait} {
          .threshold {
            left: $threshold_padding !important;
            width: $threshold_height !important;
            top: inherit !important;
            height: inherit !important;
          }

          .tap, .beat {
            height: $mark_width !important;
            width: $mark_length !important;
            margin-top: -$mark_width/2;
          }

          .beat {
            left: $threshold_padding + $mark_padding !important;
            right: inherit !important;
          }

          .tap {
            left: inherit !important;
            right: $mark_padding + $threshold_padding !important;
          }

          .link {
            left: $link_top !important;
            width: $link_height !important;
          }
        }
      }
    }

  }
}
