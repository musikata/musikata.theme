@import "../utils";
@import "../settings";
@import "../foundation-icons";

.feel-the-beat-exercise{

  > .body-region{
    height: 100%;
    width: 100%;
  }

  .tap-view, .results-view {
    height: 100%;
    width: 100%;
    display: flex;

  }

  .tap-view{
    $padding: 4%;

    .instructions {
      margin: $padding;
      font-style: italic;
      list-style: none;
      text-align: center;
      width: 100%;

      li {
        display: none;

        &.active {
          display: block;
        }

        button {
          @include round-corners(.5em);
          margin: inherit;
          padding: .5em;
        }
      }

    }

    .drum-region{
      height: 100%;
      width: 100%;
      position: relative;

      .drum-container{
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        text-align: center;
      }

      .positioner {
        display: inline-block;
        position: relative;

        .spacer {
          max-width: 100%;
          max-height: 100%;
          width: auto;
          height: auto;
          visibility: hidden;
        }
      }

      .drum {
        $radius: 48%;
        $overlayRatio: .81;
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left:0;
        width: $radius*2;
        height: $radius*2;
        @include round-corners($radius);
        background-image: url('../img/feelTheBeat/drum.jpg');
        background-size: 100% 100%;
        background-repeat: no-repeat;

        .overlay {
          $size: $overlayRatio * 100%;
          $padding: ((1 - $overlayRatio)/2) * 100%;
          opacity: 0;
          width: $size;
          height: $size;
          margin-left: $padding;
          margin-top: $padding;
          @include round-corners(50%);
          background: $primary-color;
        }

        &.disabled {
          .overlay {
            opacity: .75;
            background: gray;
          }
        }

        &:hover {
          cursor: pointer;
          .overlay {
            opacity: .2;
          }
        }

        &.tapping{
          .overlay {
            opacity: .5;
          }
        }
      }
    }

    // Responsive styling for tap view.
    @media #{$landscape} {
      flex-direction: row;
    }

    @media #{$portrait} {
      flex-direction: column;
    }

    > div {
      flex: 1 1 50%;
      align-self: center;
    }

    .text-region {
      order: 0;
      display: flex;
      align-items: center;
    }

    .drum-region {
      order: 1;
    }

    .drum-container {
      display: flex;
      @media #{$landscape} {
        flex-direction: column;
      }
      @media #{$portrait} {
        flex-direction: row;
      }

      &:before, &:after {
        content: "";
        flex: 1 1 auto;
      }
      .positioner {
        flex: 0 1 auto;
        align-self: center;
      }
    }
  }



  .results-view {

    $threshold_padding: 5%;
    $threshold_height: 100% - 2*$threshold_padding;
    $mark_width: 1%;
    $mark_length: 42%;
    $mark_padding: 2%;
    $link_top: $threshold_padding + $mark_padding + $mark_length;
    $link_height: $threshold_height - 2*$mark_length - 2*$mark_padding;

    padding-left: 1em;
    padding-right: 1em;

    flex-direction: column;

    i.pass {
      @include fi-check;
      color: $pass_color;
    }

    i.fail {
      @include fi-x;
      color: $fail_color;
    }

    .text {
      flex: 0 0 auto;
      text-align: center;
      @include round-corners(rem-calc(8));
      &.pass {
        background-color: $pass_color;
      }

      &.fail {
        background-color: $fail_color;
        color: white;
      }
    }

    .figure {
      $icon_size: 1em;
      flex: 1 1 auto;
      align-self: stretch;
      display: flex;
      flex-direction: column;
      position: relative;
      width: 100%;
      height: 100%;

      .result-indicators {
        flex: 0 0 $icon_size;
        align-self: center;
        width: 100%;
        position: relative;

        .result {
          $radius: $icon_size;
          position: absolute;
          font-size: $icon_size;
          width: $radius*2;
          height: $radius*2;
          @include round-corners($radius);
          text-align: center;
          margin-left: -$radius;

          i {
            display: inline-block;
            vertical-align: middle;
            line-height: 2em;
          }

          &.pass {
            i {
              @include fi-check;
              color: $pass_color;
            }
          }

          &.fail {
            i {
              @include fi-x;
              color: $fail_color;
            }
          }
        }
      }

      .timeline {
        flex: 1 1 auto;
        align-self: stretch;
        width: 100%;
        height: 100%;
        position: relative;

        > div, svg{
          position: absolute;
        }

        .threshold {
          top: $threshold_padding;
          height: $threshold_height;
          border: thin dashed #666;
        }

        .tap, .beat {
          width: $mark_width;
          margin-left: -$mark_width/2;
          height: $mark_length;
          //border: thin solid #333;
        }

        .beat {
          top: $threshold_padding + $mark_padding;
          background: #3d1c1c;
        }

        .tap {
          bottom: $mark_padding + $threshold_padding;
          &.pass {
            background: $pass_color;
          }
          &.fail {
            background: $fail_color;
          }
        }

        .link {
          top: $link_top;
          height: $link_height;
          line {
            stroke-width: 1;
            stroke: black;
            stroke-dasharray: 2,2; 
          }
        }

      }
    }

  }
}
